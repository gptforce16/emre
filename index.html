<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
    <title>Basınç Hesaplama</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
      }
      th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: center;
      }
      input, select {
        width: 100%;
        padding: 5px;
        box-sizing: border-box;
      }
      button {
        margin-top: 10px;
        padding: 10px;
      }
    </style>
  </head>
  <body>
    <h1>Nokta Ekle</h1>
    <table>
      <thead>
        <tr>
          <th>Kot</th>
          <th>Mesafe</th>
          <th>Boru Çapı</th>
          <th>Atü</th>
          <th>Hız</th>
          <th>İşletme Basıncı</th>
        </tr>
      </thead>
      <tbody id="noktalar"></tbody>
    </table>
    <button onclick="ekleNokta()">Nokta Ekle</button>
    <button onclick="hesapla()">Hesapla</button>

    <script>
      const boruCaplari = {
        "110": 96.8,
        "125": 110.2,
        "140": 123.4,
        "160": 141.0,
        "180": 158.6,
        "200": 176.2,
        "225": 198.2,
        "250": 220.4,
        "280": 246.8,
        "315": 277.6,
        "355": 312.8,
        "400": 352.6,
        "450": 396.6,
      };

      function ekleNokta() {
        const tablo = document.getElementById("noktalar");
        const satir = document.createElement("tr");

        satir.innerHTML = `
          <td><input type="number" class="kot" placeholder="m"></td>
          <td><input type="number" class="mesafe" placeholder="m"></td>
          <td>
            <select class="boru">
              ${Object.keys(boruCaplari).map(cap => `<option value="${cap}">${cap}</option>`).join('')}
            </select>
          </td>
          <td>
            <select class="atu">
              <option value="10">10</option>
              <option value="16">16</option>
            </select>
          </td>
          <td><input type="number" class="hiz" readonly></td>
          <td><input type="text" class="basinc" readonly></td>
        `;
        tablo.appendChild(satir);
      }

      function hesapla() {
        const satirlar = document.querySelectorAll("#noktalar tr");
        let oncekiKot = 0;
        let toplamMesafe = 0;

        satirlar.forEach(satir => {
          const kot = parseFloat(satir.querySelector(".kot").value) || 0;
          const mesafe = parseFloat(satir.querySelector(".mesafe").value) || 0;
          const boru = satir.querySelector(".boru").value;
          const atu = parseFloat(satir.querySelector(".atu").value);

          const cap_mm = boruCaplari[boru];
          const cap_m = cap_mm / 1000;
          const alan = Math.PI * Math.pow(cap_m / 2, 2);

          // Örnek sabit debi (L/s cinsinden), gerçek projede kullanıcıdan alınabilir
          const debi = 10;
          const hiz = (debi / 1000) / alan;
          satir.querySelector(".hiz").value = hiz.toFixed(2);

          toplamMesafe += mesafe;
          const yukseklikFarki = kot - oncekiKot;
          oncekiKot = kot;

          const basinc = atu - (toplamMesafe * 0.02) - (yukseklikFarki * 0.1);
          satir.querySelector(".basinc").value = basinc.toFixed(2) + " bar";
        });
      }
    </script>
  </body>
</html>